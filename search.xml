<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>视频切片并加密</title>
      <link href="/2021/06/29/%E8%A7%86%E9%A2%91%E5%88%87%E7%89%87%E5%B9%B6%E5%8A%A0%E5%AF%86/"/>
      <url>/2021/06/29/%E8%A7%86%E9%A2%91%E5%88%87%E7%89%87%E5%B9%B6%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="使用ffmpeg视频切片与加密"><a href="#使用ffmpeg视频切片与加密" class="headerlink" title="使用ffmpeg视频切片与加密"></a>使用ffmpeg视频切片与加密</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">openssl rand  16 &gt; encrypt.key <span class="comment"># key</span></span><br><span class="line">openssl rand -hex 16 <span class="comment"># IV</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建hls_key_info_file </span></span><br><span class="line"><span class="comment"># 格式</span></span><br><span class="line">Key URI</span><br><span class="line">Path to key file  </span><br><span class="line">IV</span><br><span class="line"></span><br><span class="line"><span class="comment"># eg enc.keyinfo</span></span><br><span class="line"><span class="comment"># http://localhost:8080/encrypt.key </span></span><br><span class="line"><span class="comment"># encrypt.key</span></span><br><span class="line"><span class="comment"># IV</span></span><br></pre></td></tr></table></figure><p>要保证key url可以访问到, 可以在测试目录下使用 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 8080 <span class="comment"># eg http://localhost:8080/encrypt.key </span></span><br></pre></td></tr></table></figure><p>生成m3u8文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> ffmpeg -y</span><br><span class="line">-i test.mp4 </span><br><span class="line">-hls_time 6 <span class="comment"># 将test.mp4分割成每个小段多少秒</span></span><br><span class="line">-hls_key_info_file enc.keyinfo</span><br><span class="line">-hls_playlist_type vod   <span class="comment"># vod 是点播</span></span><br><span class="line">-hls_segment_filename <span class="string">&quot;test%d.ts&quot;</span> <span class="comment">#  每个小段的文件名</span></span><br><span class="line">test.m3u8   <span class="comment">#  生成的m3u8文件</span></span><br><span class="line"></span><br><span class="line">ffmpeg -y -i test.mp4 -hls_time 6 -hls_key_info_file enc.keyinfo -hls_playlist_type vod -hls_segment_filename <span class="string">&quot;test%d.ts&quot;</span> test.m3u8 </span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/codeAB/p/9184266.html">本文参考</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
            <tag> hls </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
