<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>视频切片并加密</title>
      <link href="/2021/06/29/shi-pin-qie-pian-bing-jia-mi/"/>
      <url>/2021/06/29/shi-pin-qie-pian-bing-jia-mi/</url>
      
        <content type="html"><![CDATA[<h1 id="使用ffmpeg视频切片与加密"><a href="#使用ffmpeg视频切片与加密" class="headerlink" title="使用ffmpeg视频切片与加密"></a>使用ffmpeg视频切片与加密</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl rand  <span class="token number">16</span> <span class="token operator">></span> encrypt.key <span class="token comment"># key</span>openssl rand -hex <span class="token number">16</span> <span class="token comment"># IV</span><span class="token comment"># 新建hls_key_info_file </span><span class="token comment"># 格式</span>Key URIPath to key <span class="token function">file</span>  IV<span class="token comment"># eg enc.keyinfo</span><span class="token comment"># http://localhost:8080/encrypt.key </span><span class="token comment"># encrypt.key</span><span class="token comment"># IV</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>要保证key url可以访问到, 可以在测试目录下使用 </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python -m http.server <span class="token number">8080</span> <span class="token comment"># eg http://localhost:8080/encrypt.key </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>生成m3u8文件</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"> ffmpeg -y-i test.mp4 -hls_time <span class="token number">6</span> <span class="token comment"># 将test.mp4分割成每个小段多少秒</span>-hls_key_info_file enc.keyinfo-hls_playlist_type vod   <span class="token comment"># vod 是点播</span>-hls_segment_filename <span class="token string">"test%d.ts"</span> <span class="token comment">#  每个小段的文件名</span>test.m3u8   <span class="token comment">#  生成的m3u8文件</span>ffmpeg -y -i test.mp4 -hls_time <span class="token number">6</span> -hls_key_info_file enc.keyinfo -hls_playlist_type vod -hls_segment_filename <span class="token string">"test%d.ts"</span> test.m3u8 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.cnblogs.com/codeAB/p/9184266.html">本文参考</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
            <tag> hls </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
